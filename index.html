<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>地圖標註系統</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <!-- 側邊欄 -->
        <div class="sidebar">
            <h1>地圖標註系統</h1>
            
            <!-- 組別管理 -->
            <div class="group-management">
                <h2>組別管理</h2>
                <div class="group-controls">
                    <input type="text" id="groupNameInput" placeholder="輸入組別名稱">
                    <button id="addGroupBtn">新增組別</button>
                </div>
                <div id="groupsList" class="groups-list"></div>
            </div>

            <!-- 標註點列表 -->
            <div class="markers-section">
                <h2>標註點</h2>
                <div id="markersList" class="markers-list"></div>
            </div>

            <!-- 位置提醒設定 -->
            <div class="notification-settings">
                <h2>提醒設定</h2>
                <label>
                    <input type="checkbox" id="enableNotifications" checked>
                    啟用位置提醒
                </label>
                <div class="distance-setting">
                    <label for="alertDistance">提醒距離 (公尺):</label>
                    <input type="number" id="alertDistance" value="100" min="10" max="1000">
                </div>
                <div class="interval-setting">
                    <label for="alertInterval">提醒間隔 (秒):</label>
                    <input type="number" id="alertInterval" value="30" min="5" max="300">
                </div>
            </div>

            <!-- 當前位置資訊 -->
            <div class="location-info">
                <h2>當前位置</h2>
                <div id="currentLocation">定位中...</div>
                <button id="centerMapBtn">回到當前位置</button>
            </div>
        </div>

        <!-- 地圖容器 -->
        <div class="map-container">
            <div id="map"></div>
            
            <!-- 浮動控制面板 -->
            <div class="floating-controls">
                <button id="addMarkerBtn" class="control-btn">
                    <span>📍</span>
                    標註模式
                </button>
                <button id="trackingBtn" class="control-btn">
                    <span>📍</span>
                    開始追蹤
                </button>
            </div>
        </div>
    </div>

    <!-- 通知彈窗 -->
    <div id="notificationModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>位置提醒</h2>
            <p id="notificationMessage"></p>
        </div>
    </div>

    <!-- 標註點詳情彈窗 -->
    <div id="markerModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>標註點詳情</h2>
            <form id="markerForm">
                <label for="markerName">名稱:</label>
                <input type="text" id="markerName" required>
                
                <label for="markerDescription">描述:</label>
                <textarea id="markerDescription" rows="3"></textarea>
                
                <label for="markerGroup">所屬組別:</label>
                <select id="markerGroup"></select>
                
                <label for="markerSubgroup">所屬群組:</label>
                <select id="markerSubgroup"></select>
                
                <div class="form-buttons">
                    <button type="submit">保存</button>
                    <button type="button" id="deleteMarkerBtn">刪除</button>
                    <button type="button" class="cancel">取消</button>
                </div>
            </form>
        </div>
    </div>

    <!-- 初始設定彈窗 -->
    <div id="initialSetupModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>🎯 歡迎使用地圖標註系統</h2>
            <div class="setup-content">
                <div class="setup-section">
                    <h3>選擇預設組別</h3>
                    <p>選擇一個組別作為開始使用的預設組別，您可以隨時在左側面板切換。</p>
                    <select id="defaultGroupSelect">
                        <option value="">不選擇預設組別</option>
                    </select>
                    <button id="createFirstGroupBtn" class="secondary-btn">建立第一個組別</button>
                </div>
                
                <div class="setup-section">
                    <h3>提醒設定</h3>
                    <div class="setup-grid">
                        <div class="setup-item">
                            <label for="setupAlertDistance">提醒距離 (公尺):</label>
                            <input type="number" id="setupAlertDistance" value="100" min="10" max="1000">
                        </div>
                        <div class="setup-item">
                            <label for="setupAlertInterval">提醒間隔 (秒):</label>
                            <input type="number" id="setupAlertInterval" value="30" min="5" max="300">
                        </div>
                    </div>
                </div>
                
                <div class="setup-section">
                    <h3>位置權限</h3>
                    <p>為了提供位置提醒功能，我們需要獲取您的位置權限。</p>
                    <label class="checkbox-label">
                        <input type="checkbox" id="setupEnableLocation" checked>
                        啟用位置追蹤和提醒
                    </label>
                </div>
            </div>
            
            <div class="setup-buttons">
                <button id="startUsingBtn" class="primary-btn">開始使用</button>
                <button id="skipSetupBtn" class="secondary-btn">跳過設定</button>
            </div>
        </div>
    </div>

    <!-- 建立組別彈窗 -->
    <div id="createGroupModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>建立新組別</h2>
            <form id="createGroupForm">
                <label for="newGroupName">組別名稱:</label>
                <input type="text" id="newGroupName" placeholder="例如：工作地點、休閒場所" required>
                
                <label for="newGroupDescription">組別描述 (可選):</label>
                <textarea id="newGroupDescription" rows="2" placeholder="描述這個組別的用途"></textarea>
                
                <div class="form-buttons">
                    <button type="submit">建立組別</button>
                    <button type="button" class="cancel">取消</button>
                </div>
            </form>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="script.js"></script>
</body>
</html>